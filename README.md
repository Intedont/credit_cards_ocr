# credit_cards_ocr

В этом репозиотрии реализована система распознавания данных банковской карты по фотографии различными методами (v1_0 и v2_0). Наилучшую accuracy (0.92) дает v2_0 метод.  

Первая версия (v1_0) использует paddleOCR из коробки без дополнительного обучения. Выделение номера и срока действия производится регулярками.  

Во второй (v2_0) версии использованы переобученные модели yolo и mmocr. Yolo детектит номер на банковской карте, вырезанная область передается модели распознавания  (наилучшие результаты дала satrn из mmocr). Датасет для детекции (300 изображений в трейне и 50 в валидации) был собран на основе изображений карт разных банков спарсенных из поиска. Датасет для дообучения модели распознавания был получен из датасета для детекции + сгенерированные номера карт (итого около 10000 изображений).
Полученные модели работают прекрасно: yolo дает 100% accuracy при детекции номера, satrn 92% accuracy на распознавание номеров и 99% recall и precision на распознавание символов в номере.  

Запуск:  
1. > git clone
2. > cd v2_0  
3. Установить [mmocr](https://github.com/open-mmlab/mmocr) и [paddleocr](https://github.com/PaddlePaddle/PaddleOCR) по официальной инструкции (mmocr устанавливается как то особенно, поэтому pip install -r requirements не канает) 
4. Клонировать [yolov5](https://github.com/ultralytics/yolov5) репозиторий в папку v2_0/yolov5 (стандартное расположение). Yolov5 репозиторий нужен для локальной загрузки yolo модели без использования интернет соединения  
5. Скачать модели [yolo и mmocr(satrn)](https://drive.google.com/drive/folders/1T2F4SfnopxwQdlJXjpNunQL5SIknfnPo?usp=sharing) (или обучить самостоятельно) и поместить в соостветсвующие папки в v2_0/models вместо файлов model.txt  
6. Запустить run.py
